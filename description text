One area where sports analytics plays a key role in team sports is player evaluation. In order to efficiently assess and identify undervalued players, it is essential to accurately measure their abilities to find the hidden value. In more static sports like baseball, the performance is very intuitive and fairly easy to quantity as the starting point of the ball is always the same before each play. The approaches are a bit bit different in dynamic sports such as football, ice hockey, or basketball. Quantitative approach to player performance evaluation are oftentimes based on estimating an expected value for a specific outcome using contextual characteristics that describe the state of play. With that, analysts can find single values that evaluate player performance in dynamic scenarios that are far more meaningful than conventional statistics (goals, assists, etc.). 

A major framework in estimating an expected value is the expected goal value (xG). This statistic is also widely known among non-analytical sports fans and has become an indispensable part of television broadcasts and game statistics. The approach behind these statistics is relatively simple: each shot is assigned a certain xG value, which is calculated based on components such as the distance to the goal, the angle of the ball or puck to the goal when the shot is taken, and a few other factors that can be added depending on the desired complexity of the model. The xG value is usually used to show which team had the better chances. From this, one could simply interpret which team statistically deserved to win the game. But this statistic can be used for more than that. In addition to the team level just explained, xG values can also be broken down to individual players. The values can be directly assigned to players, i.e., when a player takes a shot, the respective xG value is directly assigned to that player. However, another option is to use xG to evaluate players when they are on the field or ice. By adjusting for the opponents offense and defense strength and also for the own line strength would allow you to measure a player's indirect and clean impact on their team's chances. The results is a weighted xG stat (wxG). This statistic would control for the bias of standard xG or on-ice metrics, as these are heavily skewed by teammates, opponents, and usage. These statistics help measure a playerâ€™s pure offensive and defensive quality as well as their overall impact (neutralized by teammates and opponents). In addition, value can be identified, which forms an interesting baseline for scouting, for example. Players could also be assigned roles (top 6, bottom 6, shutdown, PK specialist). To anticipate things, this approach offers a baseline approach within the framework of the wxG. There are methods that do a better job in controlling the endogenous team effect and better isolate the impact of individual players. Players who are on the ice with McDavid automatically get better ratings, and the weighted approach implemented in this model can only compensate for this to a limited extent. Models like WOWY or RAPM do a more advance job in that regard. Nevertheless, this model offers interesting and meaningful findings and provides a good impression of the top performers in chance control. The methodology is presented below.

First, the simple xG values for each shot must be calculated. The data set I used to build this model is from the hockeyR package in R and refers to the 2023/24 season. The available data set is good enough for calculating solid xG values, as it specifies the x-y coordinates, distance, and angle toward the goal for every shot taken during the season (whether on target or off target). In order to estimate the probability of a goal as accurately as possible, I deliberately chose an XGBoost model: this gradient boosting algorithm is ideal for nonlinear relationships, can automatically map interactions between variables, and in practice delivers very robust and accurate predictions. The model calculates a goal probability (xG) for each individual shot, which was then integrated into the complete shot data set.
This dataset builds the foundation to quantify the offensive and defensive contributions of all players. For each shot event, the xG value was distributed among the players involved on the ice: offensive players receive the xG values of their own shots (xGF), while defenders are assigned the expected goals against (xGA) of the opposing shots. Aggregating across all shots yields a comprehensive value for each player's contribution to chance generation and shot suppression.  The problem with this stat is, that it is heavily influenced by playing time. The graph below shows the relationship between the xG values of players and their playing time. You can clearly see a strong relationship on both sides of 0 when fitting a smoothed line to the scatterplot. To adjust for that, these raw values were then converted into xG values per 60 minutes using individual ice time in order to compare players fairly, regardless of their actual playing time.
In the second part of the project, I expanded the original xG model by directly incorporating the quality of teammates and opponents into the evaluation of each individual shot. The reason for this is that raw xG values reflect the difficulty of a shot, but do not take into account who the shot was taken against or what support a player had on the ice. Players who regularly compete against top lines or play with weak teammates are systematically disadvantaged, while others benefit from particularly strong line mates. The goal was therefore to create a context-adjusted measure that more fairly reflects individual performance.
For each shot, I first identified the offensive and defensive players involved and assigned a unique shot ID to each event. I then calculated the average defensive strength of the opposing players on the ice, using the xGA60 metric (expected goals against per 60 minutes) as an indicator of defensive quality. A strong defense has low xGA60 values, shots against such players are typically more difficult. Therefore, xG values for shots against strong defenders were weighted upwards, while shots against weaker defenders were only slightly adjusted. This weighting is done using a transformed scale that converts relative strength into a factor between 0 and 1.

A similar approach was used for the offensive side: xGF60 was used to determine how strong a shooter's offensive line is. A strong offense makes it easier to generate high-quality chances, which is why shots from such players should be weighted more heavily from a defensive perspective. Based on this logic, shots that had to be defended against strong offensive lines were weighted more heavily, while actions against weak attacking groups were given less weight.
The weighted xG values were then distributed back to the players involved: offensive players received weighted xGF values (wxGF), defenders received correspondingly weighted xGA values (wxGA).

Finally, all values were normalized to ice time so that weighted xG differences per 60 minutes could be calculated for each player. This results in a context-adjusted metric that not only takes into account the quality of the shots themselves, but also how difficult the game situations actually were for the respective player. The result is a much fairer and more realistic picture of a player's individual influence on chance creation and defensive impact.


Overall, weighted xG analysis provides a much more nuanced picture of individual player performance than traditional metrics such as raw xG values or plus/minus. By adjusting for context, i.e., the quality of teammates, the strength of opponents, and game situations, it becomes clear which players are actually generating their own impact and which are benefiting more from their environment. It is striking that some teams have a disproportionate number of players in the upper ranges of the wxG distribution. In Edmonton, for example, this is because their top players are often deployed against strong matchups and consistently generate high-quality chances despite these difficult circumstances, which the model rates accordingly higher.


Although the model presented offers some interesting solutions, it has limitations and constraints. One major problem that has only been addressed to a limited extent is the effect of teammates in this model. Although attempts have been made to counteract this, it could just as easily be the case that this effect is immediately negated by the matchup effect, meaning that Hyman, for example, benefits from being on the ice with McDavid because opponents try to play their best players against McDavid. This problem is called endogeneity, the variable we want to correct depends on the result. The main question here is how does the xG change when that particular player is on the ice, with the same teammates and opponents? This is only possible if all player effects are estimated simultaneously which is not given in this model. This is the core idea behind every APM method, which should work better in this case. 
